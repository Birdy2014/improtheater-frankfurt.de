extends ../template.pug

block routeContent
    link(rel="stylesheet" href="/public/css/workshop.css")
    h1
        if loggedIn
            input.workshop-input.edit-title(type="text" autocomplete="off" value=title)
        else
            span!= marked(title)

    div
        img(class="workshop-image" src=img onclick=loggedIn ? "editWorkshopImage()" : "")
        dl(class="workshop-properties")
            dt Wann?
            dd
                if loggedIn
                    input(type="date" value=dateISO class="input-workshop-date")
                else
                    | #{dateText}
            dd
                if loggedIn
                    input(type="time" value=beginTimeISO class="input-workshop-time-begin")
                    | - 
                    input(type="time" value=endTimeISO class="input-workshop-time-end")
                else
                    | #{timeText}
            dt Wo?
            dd
                if loggedIn
                    input.workshop-input.edit-workshop-location(type="text" autocomplete="off" value=location)
                else
                    span!= marked.parseInline(location)
            dt Kosten?
            dd
                if loggedIn
                    input.workshop-input.edit-workshop-price(type="text" autocomplete="off" value=price)
                else
                    span!= marked.parseInline(price)
            dt Anmelden?
            dd
                if loggedIn
                    input.workshop-input.edit-workshop-email(type="text" autocomplete="off" value=email)
                else
                    span!= marked.parseInline(email)
            if loggedIn
                dt Farbe?
                dd
                    input(type="color" value=color class="input-workshop-color")
                    | #{color}

    if loggedIn
        .workshop-content
            p Die Bearbeitungsansicht unterstützt #[a(href="https://guides.github.com/features/mastering-markdown/") Markdown]
            textarea.edit-content(name="content-" + id) !{content}
            //- The textarea name is important, because the browser will autocomplete content from other textareas without it
            .workshop-content-preview
    else
        div.workshop-content!= marked(content)

    if loggedIn
        a(href="javascript:void(0)" onclick="changeWorkshopValues()" class="edit-button edit-save") Speichern
        = " | "
        a(href="javascript:void(0)" onclick="toggleWorkshopPreview()" class="edit-button edit-preview") Vorschau
        = " | "
        a(href="javascript:void(0)" onclick="publishWorkshop()" class="edit-button edit-publish") #{visible ? "Unsichtbar machen" : "Veröffentlichen"}
        = " | "
        unless newsletterSent
            span.edit-newsletter
                a(href="javascript:void(0)" onclick="sendNewsletter()" class="edit-button edit-newsletter") Newsletter senden
                = " | "
                a(href="/newsletter-preview/" + id class="edit-button edit-newsletter forceReload" target="_blank") Newsletter Vorschau
                = " | "
        a(href="javascript:void(0)" onclick="deleteWorkshop()" class="edit-button") Löschen